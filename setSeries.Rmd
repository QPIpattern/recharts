---
title: "setSeries"
output: 
  html_document: 
    number_sections: yes
    toc: yes
    toc_depth: 4
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

First, you should load `recharts`:
```{r}
library(recharts)
```

# Introduction

The basic framework of making Echarts object is 
```
Step 1 echart => Step 2 set[Widgets] => Step 3 set[Aesthetics]. 
```

Step 1 makes the structure of the Echarts object, step 2 creates/modifies its widgets, and step 3 modifies the params of the widgets. But what if you want to modify the details inside series list? â€“ You may want setSeries.

`setSeries` is a bit low-level, compared to other `set[Widgets]` functions. It directly pass the param list on to an Echarts object and may lead to unexpected results. So you are suggested to get more familiar with Echarts structure before you decide to `setSeries`.

# Function Call

```r
setSeries(chart, timeslots = NULL, series = NULL, ...)
```

+----------+-------------------------------------------------------------------+
|   Arg    |  Requirement                                                    |
+==========+===================================================================+
|**chart** | Echarts object generated by `echartR` or `echart`.  |
+----------+-------------------------------------------------------------------+
|timeslots | vector of timeslots, either name or index of timeline variable `z`. If set NULL, the function applies to all the timeslots. |
+----------+-------------------------------------------------------------------+
| series   | series, could be the name or the index of the series. When the string is not in the existing series list, it will be treated as new. If set NULL, the function applies to all the series. |
+----------+-------------------------------------------------------------------+
| ...      | Elipsis, containing the params to pass to the echarts object for modification. 
+----------+-------------------------------------------------------------------+

The generic params include: `'type', 'name', 'tooltip', 'data', 'itemStyle', 'markPoint', 'markLine', 'clickable', 'z', 'zlevel'`. 

The type-specific params include:

Chart Type | Supported Features
-----------|-------------------------------------------------------------------
**line** | 'stack', 'xAxisIndex', 'yAxisIndex', 'symbol', 'symbolSize', 'symbolRotate', 'showAllSymbol', 'smooth', 'dataFilter', 'legendHoverLink'
**bar** | 'stack', 'xAxisIndex', 'yAxisIndex', 'barGap', 'barCategoryGap', 'barMinHeight', 'barWidth', 'barMaxWidth', 'legendHoverLink'
**scatter** | 'xAxisIndex', 'yAxisInde, x', 'symbol', 'symbolSize', 'symbolRotate', 'large', 'largeThreshold', 'legendHoverLink'
**pie** | 'legendHoverLink', 'center', 'radius', 'startAngle', 'minAngle', 'clockWise', 'roseType', 'selectedOffset', 'selectedMode'
**radar** | 'symbol', 'symbolSize', 'symbolRotate', 'legendHoverLink', 'polarIndex'
**chord** | 'symbol', 'symbolSize', 'clockWise', 'categories', 'links', 'matrix', 'minRadius', 'maxRadius', 'ribbonType', 'showScale', 'showScaleText', 'padding', 'sort', 'sortSub', 'nodes'
**force** | 'symbol', 'symbolSize', 'large', 'center', 'roam', 'categories', 'links', 'matrix', 'size', 'minRadius', 'maxRadius', 'linkSymbol', 'linkSymbolSize', 'scaling', 'gravity', 'draggable', 'useWorker', 'steps', 'nodes'
**map** | 'selectedMode', 'mapType', 'hoverable', 'dataRangeHoverLink', 'mapLocation', 'mapValueCalculation', 'mapValuePrecision', 'showLegendSymbol', 'roam', 'scaleLimit', 'nameMap', 'textFixed', 'geoCoord', 'heatmap'
**gauge** | 'legendHoverLink', 'center', 'radius', 'startAngle', 'endAngle', 'min', 'max', 'splitNumber', 'axisLine', 'axisTick', 'axisLabel', 'splitLine', 'pointer', 'title', 'detail'
**funnel** | 'legendHoverLink', 'sort', 'min', 'max', 'x', 'y', 'x2', 'y2', 'width', 'height', 'funnelAlign', 'minSize', 'maxSize', 'gap'
**eventRiver** | 'xAxisIndex', 'legendHoverLink', 'weight'
**treemap** | 'center', 'size', 'root'
**tree** | 'symbol', 'symbolSize', 'roam', 'rootLocation', 'layerPadding', 'nodePadding', 'orient', 'direction'
**wordCloud** | 'center', 'size', 'textRotation', 'autoSize'
**heatmap** | 'blurSize', 'gradientColors', 'minAlpha', 'valueScale', 'opacity'

# Showcase

## Data Preparation

Let's use 4 data sets: 

**timeline**   |   **mono series**  |  **multi series**
---------------|----------------|-----------------
**no**         |   `g1`           |  `g2`
**yes**        |   `g3`           |  `g4`

```{r}
require(data.table)
aq <- airquality
aq$Date <- as.Date(paste('1973', aq$Month, aq$Day, sep='-'))
g1 <- echartr(aq, Date, Temp, type='curve')
g2 <- echartr(aq, Day, Temp, Month, type='curve')
g3 <- echartr(aq, Day, Temp, z=Month, type='curve')
aq1 <- melt(aq, id=c('Month', 'Day'), measure=c('Temp', 'Wind'), 
            variable='Param')
g4 <- echartr(aq1, Day, value, Param, z=Month, type='curve')
```

## Original Charts

```{r, echo=FALSE}
g1
g2
g3
g4
```

## Modification

`setSeries` can modify everything within series.

You can modify chart type.

```{r}
g1 %>% setSeries(type='bar')
```

You can limit the modification in some certain series...

```{r}
g2 %>% setSeries(series='5', itemStyle=list(normal=itemStyle(
    lineStyle=lineStyle(shadowBlur=5, shadowColor='darkgray'))))
```

or timeslots... 

> But the features tend to inherit by timeslot, so you need to reset the features on the following timeslot to block the inheritibility.

```{r}
g3 %>% setSeries(timeslots='5', itemStyle=list(normal=itemStyle(
    lineStyle=lineStyle(shadowBlur=5, shadowColor='darkgray')))) %>%
    setSeries(timeslots='6', itemStyle=list(normal=itemStyle(
    lineStyle=lineStyle(shadowBlur=0))))
```

or combination of series and timeslots. 

```{r}
g4 %>% setSeries(timeslots='5', series='Temp', itemStyle=list(normal=itemStyle(
    lineStyle=lineStyle(shadowBlur=5, shadowColor='darkgray')))) %>%
    setSeries(timeslots='6', series='Temp', itemStyle=list(normal=itemStyle(
        lineStyle=lineStyle(shadowBlur=0)
    )))
```

# References

<http://echarts.baidu.com/echarts2/doc/option.html#title~series-i>
